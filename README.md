# 1.项目概述
- 代码主要用于处理电商直播平台(天猫、抖音)的主播排班数据和费用数据,自动计算主播费用统计结果。系统支持多平台数据处理,包括天猫、抖音奢美店和抖音PY旗舰店。
- 运行说明：在终端执行命令：python main.py --platform [tmall/douyinshemei/douyinpy]
# 2. 系统功能
## 2.1 核心功能
- 处理主播排班表数据
- 处理平台费用数据
- 计算主播费用统计
- 支持多种时间处理方法
- 自动合并抖音数据文件
## 2.2 目前计算平台
- 天猫、抖音奢美店、抖音PY旗舰店
# 3. 系统配置
## 3.1 配置文件(config.yaml)
- 包含：天猫、抖音奢美店、抖音PY旗舰店的查询时间范围，输入文件位置，输出文件位置，时间处理方法
- 支持4种时间处理方法:
  - method1: (最短) 大于30分钟向上取整,结束时间向下取整
  - method2: (向后) 大于30分钟向上取整,结束时间向上取整
  - method3: (向前) 大于30分钟向下取整,结束时间向下取整
  - method4: (最长) 大于30分钟向下取整,结束时间向上取整
# 4. 输入输出说明
## 4.1 main.py（主程序）
### 4.1.1 输入
1. 排班表文件(.xlsx格式)：必须包含日期列，花费列，文件放在配置文件指定路径
2. 主播信息文件(.xlsx格式): 有4列，一列为日期，其余3列格式为："主播名(时间段)"[需要手动将无用数据删除，例如:开会(10:00-12:00)]，时间段格式: "HH:MM-HH:MM"，文件放在配置文件指定路径
### 4.1.2 输出
主播花费统计表(.xlsx格式)：包含4列[主播，合计，起始时间，截止时间]，文件保存在配置文件指定路径
## 4.2合并文件.py（针对抖音平台）
    作用：处理多个抖音数据文件
### 4.2.1 输入
从巨量千川下载文件（按‘时’下载，一次只能下载7天的），下载处理的文件名称为：‘全域推广-投后数据-*.xlsx’，即输入文件[需要手动修改files中的path]
### 4.2.2 输出
输出：f'{path[0]}/抖音奢美报表.xlsx'（即主程序的输入文件）
# 5. 错误处理
- 系统会处理以下错误情况:
 - 日期范围验证
 - 文件读写权限检查
 - 输入数据格式验证
 - 文件存在性检查
# 6. 系统架构
-  主要模块包括:
  - 配置加载模块
  - 数据处理模块
  - 时间处理模块
  - 费用计算模块
  - 文件处理模块
  - 错误处理模块
# 7. 维护与更新
- 建议定期:
 - 检查配置文件的正确性
 - 备份重要数据
 - 验证输出结果的准确性
 - 更新平台相关配置